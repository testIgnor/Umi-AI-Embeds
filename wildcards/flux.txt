[set debugging]0[/set]


[##]
Chooses a franchise from a fixed list
[/##]
[function choose_franchise]
[set characterType]
[choose]
characters
[/choose]
[/set]
[set franchise]
[choose]
Celebs
Pstars
Divinity
Mythology
[/choose]
[/set]

[chance 33]
[set characterType]
[choose]
myspecies
[/choose]
[/set]
[set franchise]
[choose]
Royalty
[/choose]
[/set]
[/chance]

[set characterprompt]
<[get characterType _before=[ _after=]][get franchise _before=[ _after=]]>
[/set]

[/function]


[##]
Makes the prompt
[/##]
[function make_prompt]

[call make_single]

[/function]


[##]
Sets gender_prompt
[/##]
[function set_gender]
[set gender]female[/set]

[switch gender]
    [case "female"]
        [set gender_short]1girl[/set]
        [set eff_gen]female[/set]
    [/case]
[/switch]

[/function]


[##]
Sets age range
[/##]
[function set_age_range]

[set age_range]
upper
[/set]

[chance 80]
[set age_range]
lower
[/set]
[/chance]

[chance 30]
[set age_range]
middle
[/set]
[/chance]

[/function]


[##]
Sets age_prompt
[/##]
[function set_age gender]

[set ageprompt]
<[ezage][get gender _before=[ _after=]][get age_range _before=[ _after=]]>
[/set]

[set is_hairless]
[call wildcards/no_hair]
[/set]

[if "franchise in is_hairless"]
[set ageprompt]
<[ezage][get gender _before=[ _after=]][get age_range _before=[ _after=]][--Hairy]>
[/set]
[/if]

[/function]


[##]
Filter and choose clothing from myclothing
[/##]
[function get_clothing clothing_type]
[filter_tags clothing clothing_type="{get clothing_type}" _must_match="all"]
[choose][call wildcards/myclothing][/choose]

[/function]


[##]
Filter and choose preset from mypresets
[/##]
[function get_preset eff_gen]
[set preset_type]
[choose]
Position
Outfit
[/choose]
[/set]
[filter_tags preset_type="{get preset_type}" eff_gen="{get eff_gen}"]
[choose][call wildcards/mypresets][/choose]

[/function]


[##]
Makes a 1character prompt
[/##]
[function make_single]

[call choose_franchise]
[call set_gender]
[call set_age_range]
[call set_age gender="{get gender}"]

[set character_preset]realistic, photorealistic, photograph, NSFW, (solo:1.5), [get characterprompt], [get ageprompt][get gender_suffix], <[EZEmotion]>, <[GazeFormat]>[chance 10], <[ezpreg]>[/chance]**(person in background, people in background:2.0)**[/set]

[set prompt_suffix]
    [chance 15]
        [call get_preset eff_gen="{get eff_gen}"]
    [/chance]
    [else]
        [chance 66]
            <[imageformat]>, ([call wildcards/MyLocation]:1.3), [choose][call wildcards/myclothing][/choose]
        [/chance]
        [else]
            <[imageformat]>, ([call wildcards/MyLocation]:1.3), <[eznude][get eff_gen _before=[ _after=]]>
        [/else]
    [/else]
[/set]

[set umistring][get character_preset], [get prompt_suffix][/set]

[set retrieved_string][Umi _has_options _verbose="{get debugging}" _debug="{get debugging}"][get umistring][/Umi][/set]

[set p_prompt][remove-string asian_][remove-string source_anime,][choose _case=1][get retrieved_string][/choose][/remove-string][/remove-string][/set]

[/function]


[##]
Main function
[/##]
[function main_function]

[call make_prompt]

[set global_lora]
[choose]
<lora:NSFW_master:1>
<lora:nsfw_flux_lora_v1:1> AiArtV
[/choose]
[/set]

[strip-lora][get p_prompt][/strip-lora] [get global_lora]

[/function]

[call main_function]